<div class="row">
    <div class="col-md-12">
        <h1 translate>Manage Organisations</h1>
    </div>
</div>

<div class="row" ng-show="loading">
    <div class="col-md-12">
        <div>
            <i class="fa fa-spinner fa-spin"></i> <span translate>Loading...</span>
        </div>
    </div>
</div>

<div ng-show="!loading">
    <div class="row hidden">
        <form class="form" role="form">
            <div class="form-group col-md-3">
                <label translate>Filter Name</label>
                <input class="form-control" type="text" ng-model="filter.name" placeholder="{{'Filter Name' | translate}}">
            </div>
            <div class="form-group col-md-3">
                <label translate>Filter Full name</label>
                <input class="form-control" type="text" ng-model="filter.fullname" placeholder="{{'Filter Full name' | translate}}">
            </div>
            <div class="form-group col-md-3">
                <label translate>Filter Description</label>
                <input class="form-control" type="text" ng-model="filter.description" placeholder="{{'Filter Description' | translate}}">
            </div>
            <div class="form-group col-md-3">
                <label><input type="checkbox" ng-model="filter.range_enabled"> <span translate>Filter Date</span></label>
                <input class="input-daterange form-control" type="daterange" format="L" ng-model="filter.range">
            </div>
        </form>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="btn-group pull-left">
                <button type="button" class="btn btn-default" ng-click="newDialog()" translate>New Organisation</button>
                <div class="list-title pull-left" translate translate-n="organisations.length" translate-plural="{{organisations.length}} organisations">One organisation</div>
            </div>
        </div>
    </div>
    <hr/>
    <div class="row">
        <div class="col-md-12">
            <table class="table table-responsive table-organisations ng-table-rowselected" ng-table="tableParams" show-filter="true">
                <thead>
                <tr>
                    <th class="sortable" ng-class="{
                    'sort-asc': tableParams.isSortBy('name', 'asc'),
                    'sort-desc': tableParams.isSortBy('name', 'desc')}"
                        ng-click="tableParams.sorting({'name' : tableParams.isSortBy('name', 'asc') ? 'desc' : 'asc'})">
                        <div translate>Name</div>
                    </th>
                    <th class="sortable" ng-class="{
                    'sort-asc': tableParams.isSortBy('fullname', 'asc'),
                    'sort-desc': tableParams.isSortBy('fullname', 'desc')}"
                        ng-click="tableParams.sorting({'fullname' : tableParams.isSortBy('fullname', 'asc') ? 'desc' : 'asc'})">
                        <div translate>Full name</div>
                    </th>
                    <th class="sortable" ng-class="{
                    'sort-asc': tableParams.isSortBy('description', 'asc'),
                    'sort-desc': tableParams.isSortBy('description', 'desc')}"
                        ng-click="tableParams.sorting({'description' : tableParams.isSortBy('description', 'asc') ? 'desc' : 'asc'})">
                        <div translate>Description</div>
                    </th>
                    <th class="sortable" ng-class="{
                    'sort-asc': tableParams.isSortBy('created', 'asc'),
                    'sort-desc': tableParams.isSortBy('created', 'desc')}"
                        ng-click="tableParams.sorting({'created' : tableParams.isSortBy('created', 'asc') ? 'desc' : 'asc'})">
                        <div translate>Created</div>
                    </th>
                    <th translate>Actions</th>
                </tr>
                </thead>

                <tr ng-repeat="org in $data" ng-class="{'selected': org.$selected}" ng-click="org.$selected = !org.$selected">
                    <td filter="{ 'name': 'text' }" sortable="'name'">{{org.name}}</td>
                    <td filter="{ 'fullname': 'text' }" sortable="'fullname'">{{org.fullname}}</td>
                    <td filter="{ 'description': 'text' }" sortable="'description'">{{org.description}}</td>
                    <td sortable="'created'">{{org.created | amDateFormat:'LLL'}}</td>
                    <td>
                        <div ng-if="org.$processing">
                            <i class="fa fa-spinner fa-spin"></i>
                        </div>
                        <div ng-show="!org.$processing">
                            <i class="btn btn-default fa fa-edit" title="{{'Edit Organisation'|translate}}" ng-click="editDialog(org)"/>
                            <i class="btn btn-default fa fa-trash-o" title="{{'Delete Organisation'|translate}}" ng-click="deleteDialog(org)"/>
                        </div>
                    </td>
                </tr>

            </table>

        </div>
    </div>
</div>

<script type="text/ng-template" id="editOrganisationDialog.html">
    <form role="form" name="form">

        <div class="modal-header">
            <button type="button" class="close" ng-click="cancel()" aria-hidden="true">&times;</button>
            <h4 class="modal-title">
                <span ng-show="data.organisation.create" translate>New Organisation</span>
                <span ng-show="!data.organisation.create" translate>Edit Organisation</span>
            </h4>
        </div>

        <div class="modal-body">
            <div class="row">
                <div class="form-group col-sm-6">
                    <label translate>Name</label>
                    <input type="text" class="form-control" placeholder="{{'Name'|translate}}" ng-model="data.organisation.name" required>
                </div>
                <div class="form-group col-sm-6">
                    <label translate>Full name</label>
                    <input type="text" class="form-control" placeholder="{{'Full name'|translate}}" ng-model="data.organisation.fullname">
                </div>
            </div>
            <div class="row">
                <div class="form-group col-sm-6">
                    <label translate>Logo</label>
                    <input type="url" class="form-control" placeholder="{{'Logo'|translate}}" ng-model="data.organisation.logo" required>
                </div>
                <div class="form-group col-sm-6">
                    <label translate>Website</label>
                    <input type="url" class="form-control" placeholder="{{'Website URL'|translate}}" ng-model="data.organisation.url">
                </div>
            </div>
            <div class="row">
                <div class="form-group col-sm-12">
                    <label translate>Description</label>
                    <textarea class="form-control" rows="3" placeholder="{{'Description'|translate}}" ng-model="data.organisation.description"></textarea>
                </div>
            </div>
        </div>

        <div class="modal-footer">
            <button class="btn btn-primary" ng-click="ok(form)" translate>OK</button>
            <button class="btn btn-warning" ng-click="cancel()" translate>Cancel</button>
        </div>
    </form>
</script>

<script type="text/ng-template" id="deleteOrganisationDialog.html">
    <div class="modal-header">
        <button type="button" class="close" ng-click="cancel()" aria-hidden="true">&times;</button>
        <h4 class="modal-title" translate>Delete Organisation?</h4>
    </div>
    <div class="modal-body">
        <p translate>Sure to delete organisation {{data.name}}?</p>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" ng-click="ok()" translate>OK</button>
        <button class="btn btn-warning" ng-click="cancel()" translate>Cancel</button>
    </div>
</script>

