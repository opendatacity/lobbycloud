<h1 translate>Manage Users</h1>

<div class="row" ng-show="loading">
    <div class="col-md-9">
        <div>
            <i class="fa fa-spinner fa-spin"></i> <span translate>Loading...</span>
        </div>
    </div>
</div>

<div ng-show="!loading">
<div class="row">
    <div class="col-md-12">
        <div class="btn-group pull-left">
            <button type="button" class="btn btn-default" ng-click="newDialog()" translate>New User</button>
            <div class="list-title pull-left" translate translate-n="users.length" translate-plural="{{users.length}} users">One user</div>
        </div>
    </div>
</div>
<hr/>
<div class="row">
    <div class="col-md-12">
        <table class="table" ng-show="users.length">
            <thead>
            <tr>
                <th translate>Gravatar</th>
                <th translate>Login Name</th>
                <th translate>Name</th>
                <th translate>Organisation</th>
                <th translate>Location</th>
                <th translate>Role</th>
                <th translate>Created</th>
                <th translate>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="rowuser in users">
                <td><img ng-src="http://www.gravatar.com/avatar/{{rowuser.gravatar}}.png?s=36&amp;d=mm&amp;r=pg" width="36" height="36"></td>
                <td>{{rowuser.id}}<br/>
                    <i ng-if="rowuser.email" class="fa fa-envelope-o" popover="{{rowuser.email}}" popover-trigger="mouseenter"></i>
                    <i ng-if="rowuser.verified" class="fa fa-check-circle" title="{{'Verified'|translate}}"></i>
                    <i ng-if="rowuser.description" class="fa fa-info-circle" popover="{{rowuser.description}}" popover-trigger="mouseenter"></i>
                    <a ng-if="rowuser.url" href="{{rowuser.url}}"><i class="fa fa-link" popover="{{rowuser.url}}" popover-trigger="mouseenter"></i></a>
                </td>
                <td>{{rowuser.name}}</td>
                <td>{{rowuser.organisation}}</td>
                <td>{{rowuser.location}}</td>
                <td>{{rowuser.role}}</td>
                <td>{{rowuser.created | amDateFormat:'LLL'}}</td>
                <td>
                    <div ng-if="rowuser.$processing">
                        <i class="fa fa-spinner fa-spin"></i>
                    </div>
                    <div ng-if="!rowuser.$processing">
                        <!--<i class="btn btn-default fa fa-edit fa-mouse-pointer" title="{{'Edit User'|translate}}" ui-sref='admin.user({id: rowuser.id})'/>-->
                        <i class="btn btn-default fa fa-edit fa-mouse-pointer" title="{{'Edit User'|translate}}" ng-click="editDialog(rowuser)"/>
                        <i class="btn btn-default fa fa-trash-o fa-mouse-pointer" title="{{'Delete User'|translate}}" ng-click="deleteDialog(rowuser)"/>
                    </div>
                </td>
            </tr>
            </tbody>

        </table>
    </div>
</div>
</div>

<script type="text/ng-template" id="editUserDialog.html">
    <form role="form" name="form">

        <div class="modal-header">
            <button type="button" class="close" ng-click="cancel()" aria-hidden="true">&times;</button>
            <h4 class="modal-title">
                <span ng-show="data.user.create" translate>New User</span>
                <span ng-show="!data.user.create" translate>Edit User</span>
            </h4>
        </div>

        <div class="modal-body">

            <div class="row">
                <div class="form-group col-sm-4">
                    <label translate>Login Name</label>
                    <input type="text" class="form-control" placeholder="{{'Enter login name'|translate}}" ng-model="data.user.id" required>
                </div>
                <div class="form-group col-sm-6">
                    <label translate>Password</label>
                    <input ng-if="!user.create" type="text" class="form-control" placeholder="{{'Enter password (leave empty for no changes)'|translate}}" ng-model="data.user.password">
                    <input ng-if="user.create" type="text" class="form-control" placeholder="{{'Enter password'|translate}}" ng-model="data.user.password" required>
                </div>
                <div class="form-group col-sm-2">
                    <label translate>Role</label>
                    <select ng-model="data.user.role" class="form-control" ng-options="c for c in data.userRoles" required></select>
                </div>
            </div>

            <div class="row">
                <div class="form-group col-sm-6">
                    <label translate>Full Name</label>
                    <input type="text" class="form-control" placeholder="{{'Name'|translate}}" ng-model="data.user.name">
                </div>
                <div class="form-group col-sm-6">
                    <label translate>Organisation</label>
                    <input type="text" class="form-control" placeholder="{{'Organisation'|translate}}" ng-model="data.user.organisation">
                </div>
            </div>

            <div class="row">
                <div class="form-group col-sm-6">
                    <label translate>Email</label>
                    <input type="email" class="form-control" placeholder="{{'Email adress'|translate}}" ng-model="data.user.email" required>
                </div>
                <div class="form-group col-sm-6">
                    <label translate>Website</label>
                    <input type="url" class="form-control" placeholder="{{'Website URL'|translate}}" ng-model="data.user.url">
                </div>
            </div>

            <div class="row">
                <div class="form-group col-sm-6">
                    <label translate>Location</label>
                    <input type="text" class="form-control" placeholder="{{'Location'|translate}}" ng-model="data.user.location">
                </div>
            </div>

            <div class="row">
                <div class="form-group col-sm-12">
                    <label translate>Description</label>
                    <textarea class="form-control" rows="3" placeholder="{{'Enter description'|translate}}" ng-model="data.user.description"></textarea>
                </div>
            </div>
        </div>

        <div class="modal-footer">
            <button class="btn btn-primary" ng-click="ok(form)" translate>OK</button>
            <button class="btn btn-warning" ng-click="cancel()" translate>Cancel</button>
        </div>

    </form>
</script>

<script type="text/ng-template" id="deleteUserDialog.html">
    <div class="modal-header">
        <button type="button" class="close" ng-click="cancel()" aria-hidden="true">&times;</button>
        <h4 class="modal-title" translate>Delete User?</h4>
    </div>
    <div class="modal-body">
        <p translate>Sure to delete user {{data.id}}?</p>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" ng-click="ok()" translate>OK</button>
        <button class="btn btn-warning" ng-click="cancel()" translate>Cancel</button>
    </div>
</script>

